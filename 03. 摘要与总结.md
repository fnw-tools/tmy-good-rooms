摘要与总结 { .text-center }
---------

&nbsp;

### 02.1) 从指定网页提取总结

<pre><code class="tmy-room">
{
  "room_ver": 1,
  "room_name": "从网页提取总结",
  "room_desc": "指定网址后拉取文章，从中提取指定字数的摘要。",
  
  "system_role": "你是一个友善的助手",
  "context_size": 0,
  "temperature": 0,
  "max_tokens": 600,
  
  "accept_qr_url": true,
  "globals": {"QR_URL":"","my_data":{"out_size":300,"selector":""}},
  "magic_rules": {
    "网址": [["URL","replace","{QR_URL}"]],
    "字数": [["总结字数","replace","{my_data[out_size]}"]],
    "选择": ["*"],
    "总结": []
  },
  "prompts": {
    "选择": [
      { "uri":"ADJUST",
        "input":"{QUESTION}",
        "actions":"strip",
        "save":"my_data[selector]"
      },{ "uri":"ADJUST",
        "input":"'设置选择器成功' if {my_data[selector]!r} else '清除选择器成功'"
      } ],
    "总结": [
      { "uri":"URL_FETCH",
        "input":"{QR_URL}"
      },{ "uri":"BEAUTIFUL_SOUP",
        "selector":"{my_data[selector]}"
      },{ "uri":"ADJUST",
        "actions":"slice 0 3000"
      },{
        "ask":"请从下面文字提取要点，用 {my_data[out_size]} 字作总结。\n\n###\n\n{STEP_RESULT}",
        "append_input":false,
        "max_tokens":600, "reset_context":true
      }
    ]
  },
  "hint_magics": ["网址","字数","选择","总结"],
  "state_desc": "({QR_URL} {my_data[out_size]}字)"
}
</code></pre>

从指定的网址拉取文章内容，然后从中提取指定字数的总结。
{ .tmy-room-desc }

本聊天室支持上传二维码图片，从中提取 URL 用作待拉取的文章网址，或者，用 `"网址 <URL>"` 指令安装文章网址。用 `"字数 <num>"` 修改待总结总字数要求，若不设置缺省值为 300。在文章网址已设置的情况下，输入 `"总结"`，AI 将对该文章提取摘要，返回指定字数的总结。

提示，由于受 GPT 3.5 规格限制，一次问答占用 token 数要少于 4000，所以，对于长文章内容，本工具会自动先截短到 3000 字左右，再请求 AI 作总结。 

还有一个高级用法，用户可以预先指定一个 CSS 选择器 selector，用于从文章的 html 网页中先查找符合 selector 的节点，然后从该节点提取文字信息。

特别说明：国内多数网站过度实施了 SEO 优化，网页中插入过多对阅读而言是垃圾的信息，自然对提取总结产生负面效果。如果您已识别出特定网站用于展示文章的根节点是什么（前端程序员知道怎么操作），不妨用 `"选择 <selector>"` 指令配置一下选择器。比如，对于知乎上的文章，可以这么设置选择器 `"选择 article.Post-Main"`。

&nbsp;

### 02.2) 搜索并回答问题

<pre><code class="tmy-room">
{
  "room_ver": 1,
  "room_name": "搜索并提取摘要",
  "room_desc": "先用关键词在谷歌做搜索，取结果靠前的文章，让 AI 从中提取摘要。",
  
  "system_role": "你是一个友善的助手",
  "context_size": 0,
  "temperature": 0,
  "max_tokens": 600,
  
  "globals": {
    "my_data":{"out_size":300,"selector":"","urls":[""],"empty":[""]},
    "EMPTY_URLS":[""] },
  "magic_rules": {
    "字数": [["总结字数","replace","{my_data[out_size]}"]],
    "选择": ["*"],
    "*": ["*"],
    "继续":[]
  },
  "prompts": {
    "选择": [
      { "uri":"ADJUST",
        "input":"{QUESTION}",
        "actions":"strip",
        "save":"my_data[selector]"
      },{ "uri":"ADJUST",
        "input":"'设置选择器成功' if {my_data[selector]!r} else '清除选择器成功'"
      } ],
    "*": [
      { "uri":"ADJUST",
        "input":"{EMPTY_URLS!r}",
        "save":"my_data[empty]"
      },{ "uri":"GOOGLE_TOP_SEARCH", "num":3,
        "input":"{QUESTION} -youtube.com",
        "save":"my_data[urls]"
      },{ "uri":"ADJUST",
        "INPUT":"'my_data[urls]' if {my_data[urls]!r} else 'my_data[empty]'",
        "input":"SHIFT",
        "save":"PRE_ANSWER"
      },{ "uri":"URL_FETCH"
      },{ "uri":"BEAUTIFUL_SOUP",
        "selector":"{my_data[selector]}"
      },{ "uri":"ADJUST",
        "actions":"slice 0 3000"
      },{
        "ask":"请从下面文字提取要点，用 {my_data[out_size]} 字作总结。\n\n###\n\n{STEP_RESULT}",
        "append_input":false,
        "max_tokens":600, "reset_context":true
      },{ "uri":"ADJUST", "no_output":true,
        "input":"{PRE_ANSWER}\n\n",
        "save":"PRE_ANSWER"
      } ],
    "继续": [
      { "uri":"ADJUST",
        "input":"{EMPTY_URLS!r}",
        "save":"my_data[empty]"
      },{ "uri":"ADJUST",
        "INPUT":"'my_data[urls]' if {my_data[urls]!r} else 'my_data[empty]'",
        "input":"SHIFT",
        "save":"PRE_ANSWER"
      },{ "uri":"URL_FETCH"
      },{ "uri":"BEAUTIFUL_SOUP",
        "selector":"{my_data[selector]}"
      },{ "uri":"ADJUST",
        "actions":"slice 0 3000"
      },{
        "ask":"请从下面文字提取要点，用 {my_data[out_size]} 字作总结。\n\n###\n\n{STEP_RESULT}",
        "append_input":false,
        "max_tokens":600, "reset_context":true
      },{ "uri":"ADJUST", "no_output":true,
        "input":"{PRE_ANSWER}\n\n",
        "save":"PRE_ANSWER"
      }
    ]
  },
  "hint_magics": ["字数","选择","继续"],
  "state_desc": "({my_data[out_size]}字)"
}
</code></pre>

用户输入关键词，聊天室后台依据关键词先用谷歌联网搜索，保存前 3 个搜索结果，然后自动取其中第 1 个搜索结果，读取其网页，再让 AI 依据网页内容作总结。
{ .tmy-room-desc }

然后紧接着，用户若输入 `"继续"`（或 `","`），聊天室后台自动取下一个搜索结果，读取网页让 AI 提供总结。

用户输入 `"字数 <num>"` 可以改变要求总结的字数。

用户输入 `"选择 <selector>"` 可以预先指定一个 CSS 选择器 selector，便于让系统只从文章的 html 页中找到的 selector 节点提取文字信息。

&nbsp;

### 02.3) 搜知乎并提取摘要

<pre><code class="tmy-room">
{
  "room_ver": 1,
  "room_name": "搜索知乎并提取摘要",
  "room_desc": "先用关键词在谷歌搜索知乎网站，取结果靠前的文章，让 AI 从中提取摘要。",
  
  "system_role": "你是一个友善的助手",
  "context_size": 0,
  "temperature": 0,
  "max_tokens": 600,
  
  "globals": {
    "my_data":{"out_size":300,"selector":"article.Post-Main","urls":[""],"empty":[""]},
    "EMPTY_URLS":[""] },
  "magic_rules": {
    "字数": [["总结字数","replace","{my_data[out_size]}"]],
    "选择": ["*"],
    "*": ["*"],
    "继续":[]
  },
  "prompts": {
    "选择": [
      { "uri":"ADJUST",
        "input":"{QUESTION}",
        "actions":"strip",
        "save":"my_data[selector]"
      },{ "uri":"ADJUST",
        "input":"'设置选择器成功' if {my_data[selector]!r} else '清除选择器成功'"
      } ],
    "*": [
      { "uri":"ADJUST",
        "input":"{EMPTY_URLS!r}",
        "save":"my_data[empty]"
      },{ "uri":"GOOGLE_TOP_SEARCH", "num":3,
        "input":"{QUESTION} site:zhihu.com",
        "save":"my_data[urls]"
      },{ "uri":"ADJUST",
        "INPUT":"'my_data[urls]' if {my_data[urls]!r} else 'my_data[empty]'",
        "input":"SHIFT",
        "save":"PRE_ANSWER"
      },{ "uri":"URL_FETCH"
      },{ "uri":"BEAUTIFUL_SOUP",
        "selector":"{my_data[selector]}"
      },{ "uri":"ADJUST",
        "actions":"slice 0 3000"
      },{
        "ask":"请从下面文字提取要点，用 {my_data[out_size]} 字作总结。\n\n###\n\n{STEP_RESULT}",
        "append_input":false,
        "max_tokens":600, "reset_context":true
      },{ "uri":"ADJUST", "no_output":true,
        "input":"{PRE_ANSWER}\n\n",
        "save":"PRE_ANSWER"
      } ],
    "继续": [
      { "uri":"ADJUST",
        "input":"{EMPTY_URLS!r}",
        "save":"my_data[empty]"
      },{ "uri":"ADJUST",
        "INPUT":"'my_data[urls]' if {my_data[urls]!r} else 'my_data[empty]'",
        "input":"SHIFT",
        "save":"PRE_ANSWER"
      },{ "uri":"URL_FETCH"
      },{ "uri":"BEAUTIFUL_SOUP",
        "selector":"{my_data[selector]}"
      },{ "uri":"ADJUST",
        "actions":"slice 0 3000"
      },{
        "ask":"请从下面文字提取要点，用 {my_data[out_size]} 字作总结。\n\n###\n\n{STEP_RESULT}",
        "append_input":false,
        "max_tokens":600, "reset_context":true
      },{ "uri":"ADJUST", "no_output":true,
        "input":"{PRE_ANSWER}\n\n",
        "save":"PRE_ANSWER"
      }
    ]
  },
  "hint_magics": ["字数","选择","继续"],
  "state_desc": "({my_data[out_size]}字)"
}
</code></pre>

与 "02.2 搜索并回答问题" 用法近似，让谷歌用关键词只搜索 `zhihu.com` 网站。
{ .tmy-room-desc }

本聊天室用法请参考 "02.2" 的介绍。

&nbsp;
